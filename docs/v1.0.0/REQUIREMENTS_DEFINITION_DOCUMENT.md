# keepIT v1.0.0 要件定義書

## 1. プロジェクト概要

### 1.1 目的
学習管理アプリケーション「keepIT」を開発し、個人学習者向けの学習記録・管理・モチベーション維持機能を提供する。収益化を前提とした持続可能なサービスの構築を目指す。

### 1.2 ターゲットユーザー
- 高校生・大学受験生
- 資格試験受験者
- 自己学習に取り組む社会人
- 習慣管理を頑張る人

### 1.3 競合分析
- **StudyPlus**: 累計900万人利用、大学受験生の2人に1人が利用する学習管理SNS
- **主要機能**: 学習記録、可視化、SNS機能、教材管理
- **差別化ポイント**: より**シンプルで直感的**なUI、効果的な学習継続支援機能。**社会人**をより意識

## 2. 機能要件（v1.0.0）

### 2.1 優先度A（必須機能）

#### 2.1.1 ユーザー管理機能
- **ユーザー登録**
  - メールアドレス・パスワードによる登録
  - プロフィール設定（ニックネーム、目標、志望校/資格等）
- **認証機能**
  - ログイン・ログアウト（GoogleのOIDCを利用）
  - パスワードリセット
- **プロフィール管理**
  - 基本情報編集
  - アバター設定

#### 2.1.2 学習記録機能
- **時間記録**
  - 学習開始・終了時刻の記録
  - 手動時間入力
  - 一時停止・再開機能
- **教材記録**
  - 使用教材の登録
  - 教材ごとの学習時間・進捗記録
  - ページ数・問題数の記録

#### 2.1.3 教材管理機能
- **教材データベース**
  - 教材の登録・編集・削除
  - カテゴリ別分類
  - 難易度設定
- **進捗管理**
  - 教材ごとの完了率
  - 章・単元別の進捗記録

#### 2.1.4 学習データ可視化機能
- **統計ダッシュボード**
  - 日・週・月別学習時間グラフ
  - 教材別学習時間の円グラフ
  - 累計学習時間表示
- **カレンダー表示**
  - 月間カレンダーでの学習状況可視化
  - 日別学習時間の色分け表示

### 2.2 優先度B（重要機能）

#### 2.2.1 目標設定・管理機能
- **目標設定**
  - 試験日・目標日の設定
  - 日別・週別・月別学習時間目標
  - 教材別進捗目標
- **進捗管理**
  - 目標達成率の表示
  - カウントダウン表示
  - 達成状況のアラート

#### 2.2.2 通知機能
- **学習リマインダー**
  - 学習時間の通知
  - 目標未達成時のアラート
  - 継続日数の表示・通知

#### 2.2.3 基本SNS機能
- **学習記録共有**
  - 日別学習記録の投稿
  - 達成報告の投稿
- **フォロー機能**
  - 他ユーザーのフォロー
  - タイムライン表示
- **いいね・コメント機能**
  - 投稿へのいいね
  - 簡単なコメント機能

#### 2.2.4 ランキング機能
- **ランキング表示**
  - 総学習時間ランキング（全体・フォロワー間）
  - 連続学習日数ランキング
  - 教材別ランキング（例：英語教材の学習時間上位）
- **期間指定**
  - 日・週・月単位でのランキング切り替え
- **ユーザー情報表示**
  - ニックネーム、アバター、学習時間/日数
  - 自分の順位ハイライト
- **プライバシー配慮**
  - ランキング非公開設定
  - ニックネームのみ表示（本名非表示）
- **通知連携**
  - ランクアップ時の通知
  - 目標達成者の特別バッジ表示

### 2.3 優先度C（将来実装）
- 学習グループ機能
- 詳細な学習分析機能
- 外部アプリ連携
- バーコードスキャン機能
- Googleカレンダー連携
- AIを活用した機能
- レベル/ランク機能
  - 教材別にレベルを設定

## 3. 非機能要件

### 3.1 パフォーマンス要件
- **レスポンス時間**: API応答時間 500ms以内
- **同時接続数**: 500ユーザーまで対応
- **データロード時間**: 初回ロード3秒以内

### 3.2 セキュリティ要件

#### 3.2.1 認証・認可（Google OIDC基盤）
- **OpenID Connect (OIDC) 認証**
  - Google Identity Platform を使用
  - OAuth 2.0 + OpenID Connect プロトコル準拠
  - ID Token による身元確認
- **JWT トークン管理**
  - Access Token: API アクセス用（短期間有効）
  - Refresh Token: トークン更新用（長期間有効）
  - トークンの適切なローテーション
- **認可スコープ管理**
  - 最小権限の原則に基づくスコープ設定
  - ユーザー情報アクセスの最小化（email, profile のみ）

#### 3.2.2 OIDC セキュリティ対策
- **PKCE (Proof Key for Code Exchange)**
  - モバイルアプリでの認証フロー保護
  - Authorization Code の傍受攻撃対策
- **State パラメータ**
  - CSRF (Cross-Site Request Forgery) 攻撃対策
  - ランダムな state 値による認証フロー検証
- **Nonce 検証**
  - ID Token のリプレイ攻撃対策
  - トークンの一意性保証
- **Client Secret 管理**
  - サーバーサイドでの Client Secret 保護
  - 環境変数による機密情報管理

#### 3.2.3 セッション・トークン管理
- **トークン保存**
  - Web: HttpOnly Cookie + Secure フラグ
  - Mobile: Keychain (iOS) / Keystore (Android)
- **トークン有効期限**
  - Access Token: 1時間
  - Refresh Token: 30日間
  - ID Token: 1時間
- **自動ログアウト**
  - 非アクティブ時間による自動ログアウト（24時間）
  - トークン期限切れ時の適切な処理

#### 3.2.4 データ保護
- **通信セキュリティ**
  - HTTPS通信の強制（TLS 1.2以上）
  - HSTS (HTTP Strict Transport Security) ヘッダー
  - Certificate Pinning（モバイルアプリ）
- **データベースセキュリティ**
  - 個人情報の暗号化保存
  - SQL インジェクション対策（パラメータ化クエリ）
  - データベース接続の暗号化
- **アプリケーションセキュリティ**
  - XSS（Cross-Site Scripting）対策
  - CSRF対策（SameSite Cookie）
  - Content Security Policy (CSP) ヘッダー

#### 3.2.5 プライバシー・GDPR対応
- **データ最小化**
  - 必要最小限のユーザー情報のみ取得・保存
  - Google から取得する情報の制限
- **ユーザー権利**
  - データ削除権（Right to be forgotten）
  - データポータビリティ権
  - アクセス権（データ開示）
- **同意管理**
  - 明示的なユーザー同意の取得
  - 同意撤回機能の提供

### 3.3 可用性要件
- **稼働率**: 99.5%以上
- **バックアップ**: 日次自動バックアップ
- **災害対策**: 異なるリージョンでのデータ複製

### 3.4 拡張性要件
- **ユーザー増加対応**: 10,000ユーザーまでの拡張を想定
- **機能追加対応**: モジュラー設計による機能追加の容易性

### 3.5 モバイル固有要件
- **オフライン対応**: 基本的な学習記録機能のオフライン利用
- **プッシュ通知**: 学習リマインダー、目標達成通知
- **バッテリー最適化**: バックグラウンド処理の最小化
- **デバイス連携**:
  - カメラ: 教材のバーコードスキャン（将来実装）
  - 位置情報: 学習場所の記録（オプション）
- **アプリストア要件**:
  - iOS: App Store Review Guidelines準拠
  - Android: Google Play ポリシー準拠

## 4. 技術要件

### 4.1 プラットフォーム構成
- **Webアプリケーション**: レスポンシブデザインによるデスクトップ・タブレット対応
- **モバイルアプリケーション**: iOS・Android対応のネイティブアプリ
- **共通バックエンドAPI**: Web・モバイル共通のRESTful API

### 4.2 システム構成
- **アーキテクチャ**: マイクロサービス指向
- **デプロイ**: Docker コンテナ化
- **CI/CD**: GitHub Actions

### 4.3 技術スタック

#### 4.3.1 Webフロントエンド
- **フレームワーク**: React 18.x
- **状態管理**: Redux Toolkit
- **UI ライブラリ**: Material-UI (MUI)
- **ルーティング**: React Router
- **バンドラー**: Vite
- **PWA対応**: Service Worker, Web App Manifest

#### 4.3.2 モバイルアプリ
- **フレームワーク**: React Native 0.72.x
- **状態管理**: Redux Toolkit
- **UI ライブラリ**: React Native Elements / NativeBase
- **ナビゲーション**: React Navigation
- **ビルドツール**: Expo CLI / React Native CLI
- **プッシュ通知**: Firebase Cloud Messaging (FCM)
- **ローカルストレージ**: AsyncStorage / SQLite

#### 4.3.3 バックエンドAPI
- **言語**: Python 3.11
- **フレームワーク**: FastAPI
- **データベース**: PostgreSQL 15.x
- **キャッシュ**: Redis
- **タスクキュー**: Celery
- **認証**: JWT + OAuth 2.0 (Google OIDC)
- **プッシュ通知**: Firebase Admin SDK
- **API仕様**: OpenAPI 3.0 (Swagger)

#### 4.3.4 インフラストラクチャ
- **クラウド**: AWS
- **コンテナ**: Docker, Docker Compose
- **データベースホスティング**: AWS RDS
- **ファイルストレージ**: AWS S3
- **CDN**: AWS CloudFront
- **プッシュ通知**: Firebase Cloud Messaging
- **アプリ配信**: App Store, Google Play Store

### 4.4 開発環境
- **バージョン管理**: Git (GitHub)
- **API ドキュメンテーション**: FastAPI 自動生成 + Swagger
- **テスト**:
  - Backend: pytest
  - Web Frontend: Jest + React Testing Library
  - Mobile: Jest + React Native Testing Library, Detox (E2E)
- **コード品質**: ESLint, Prettier, Black, isort
- **モバイル開発**:
  - iOS: Xcode, iOS Simulator
  - Android: Android Studio, Android Emulator
  - デバイステスト: Expo Go, TestFlight, Firebase App Distribution

### 4.5 技術選定理由

#### 4.5.1 フロントエンド技術選定（React）
**選定理由:**
- **クロスプラットフォーム対応**: React Nativeとのコードベースとスキルセットの共有
- **エコシステムの豊富さ**: 学習管理アプリに必要なグラフ・チャート系ライブラリが充実
- **開発生産性**: コンポーネント再利用性、React DevTools、Hot Reload等の開発体験
- **コミュニティ**: 大規模なコミュニティによる豊富な情報とサポート
- **将来性**: 継続的な発展と大企業での採用実績

**他選択肢との比較:**
- Vue.js: モバイル連携（Vue Native）の成熟度が低い
- Angular: 学習コストが高く、小規模アプリにはオーバースペック

#### 4.5.2 バックエンド技術選定（Python + FastAPI）
**選定理由:**
- **高性能**: FastAPIはNode.jsに匹敵する高速なパフォーマンス
- **開発効率**: 自動ドキュメント生成（Swagger UI）、型ヒントによるコード品質向上
- **将来の拡張性**: データ分析・機械学習ライブラリ（pandas、scikit-learn等）との親和性
- **非同期処理**: async/awaitによる高いスループット
- **可読性**: Pythonのシンプルで保守しやすい文法

**他選択肢との比較:**
- Node.js: データ分析・機械学習ライブラリの選択肢が限定的
- Go: 学習コストが高く、ライブラリエコシステムが相対的に小さい
- Java/Spring: 開発速度が遅く、個人開発には重厚すぎる

#### 4.5.3 データベース選定（PostgreSQL）
**選定理由:**
- **ACID準拠**: データ整合性の確保
- **JSON対応**: 柔軟なデータ構造への対応
- **拡張性**: 大量データ処理への対応力
- **AWS RDS対応**: マネージドサービスでの運用が容易

#### 4.5.4 モバイル技術選定（React Native）
**選定理由:**
- **コード共有**: WebアプリとのビジネスロジックとState管理の共通化
- **開発効率**: 単一スキルセットでiOS・Android両対応
- **ネイティブ性能**: ネイティブコンポーネントによる高いパフォーマンス
- **豊富なライブラリ**: React.jsエコシステムの活用

**他選択肢との比較:**
- Flutter: 新しい言語（Dart）の学習コストが高い
- ネイティブ開発: 開発・保守コストが2倍になる

## 5. データ設計

### 5.1 主要エンティティ

#### 5.1.1 ユーザー (User)
```
- id: Primary Key
- email: Email (Unique)
- password_hash: String
- nickname: String
- created_at: DateTime
- updated_at: DateTime
```

#### 5.1.2 教材 (Material)
```
- id: Primary Key
- user_id: Foreign Key
- title: String
- category: String
- total_pages: Integer
- difficulty_level: Integer (1-5)
- created_at: DateTime
- updated_at: DateTime
```

#### 5.1.3 学習セッション (StudySession)
```
- id: Primary Key
- user_id: Foreign Key
- material_id: Foreign Key
- start_time: DateTime
- end_time: DateTime
- duration_minutes: Integer
- pages_studied: Integer
- created_at: DateTime
- updated_at: DateTime
```

## 6. 収益化戦略

### 6.1 フリーミアムモデル
- **無料プラン**
  - 基本的な学習記録機能
  - 簡単な統計表示
  - 最大3つの教材登録
  - 月間50時間までの記録

- **プレミアムプラン** (月額980円)
  - 無制限の教材登録
  - 詳細な学習分析・レポート
  - 学習目標の詳細設定
  - データエクスポート機能
  - 広告非表示

### 6.2 その他収益化
- **教育機関向けプラン**: 学校・塾向けの管理機能付きプラン
- **アフィリエイト**: 学習教材・参考書の紹介
- **広告収入**: 無料ユーザー向けの適切な教育関連広告

### 6.3 KPI・目標指標
- **ユーザー数**: v1.0.0 リリース後6ヶ月で1,000ユーザー
- **有料転換率**: 5%以上
- **月間継続率**: 70%以上
- **収益目標**: リリース後1年で月間収益50万円

## 7. 開発スケジュール

### 7.1 Phase 1: 基盤構築 (6週間)
- **Week 1-2**: インフラ構築、認証システム、API設計
- **Week 3-4**: Webアプリケーション基盤構築
- **Week 5-6**: React Native環境構築、基本画面実装

### 7.2 Phase 2: 核心機能開発 (8週間)
- **Week 7-8**: 学習記録機能（Web・Mobile）
- **Week 9-10**: データ可視化機能（Web・Mobile）
- **Week 11-12**: 目標設定・管理機能（Web・Mobile）
- **Week 13-14**: プラットフォーム間データ同期機能

### 7.3 Phase 3: 付加機能開発 (6週間)
- **Week 15-16**: 教材管理、通知機能（Web・Mobile）
- **Week 17-18**: 基本SNS機能（Web・Mobile）
- **Week 19-20**: プッシュ通知、オフライン対応（Mobile）

### 7.4 Phase 4: 品質向上・リリース準備 (4週間)
- **Week 21-22**: テスト、バグ修正（Web・Mobile）
- **Week 23**: Webアプリデプロイ
- **Week 24**: モバイルアプリストア申請・リリース

**総開発期間**: 24週間（約6ヶ月）

## 8. リスク・制約事項

### 8.1 技術的リスク
- **パフォーマンス問題**: 大量データ処理時の性能劣化
- **セキュリティ脆弱性**: 個人情報漏洩のリスク
- **スケーラビリティ**: ユーザー増加時のシステム負荷

### 8.2 ビジネスリスク
- **競合の機能模倣**: StudyPlusや他競合による類似機能の提供
- **ユーザー獲得**: マーケティング予算制限下でのユーザー獲得
- **収益化**: 有料転換率が想定を下回るリスク

### 8.3 制約事項
- **開発リソース**: 個人開発のためのリソース制限
- **予算制限**: インフラ・マーケティング費用の制約
- **法的要件**: 個人情報保護法等の遵守必要性

